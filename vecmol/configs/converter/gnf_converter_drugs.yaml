sigma: 1
n_iter: 500  # Slightly more for larger drug molecules
# Early stopping (optional)
enable_early_stopping: False
convergence_threshold: 1e-6  # Only when early stopping enabled
min_iterations: 50

# Gradient batch size: balance speed and memory
gradient_batch_size: 2000

gradient_field_method: gaussian_hole # softmax, sfnorm, logsumexp, inverse_square, tanh, gaussian_mag, distance, gaussian_hole
temperature: 0.01 # Higher = sharper; lower = flatter
logsumexp_eps: 1e-8
inverse_square_strength: 1.0
gradient_clip_threshold: 0.3
gaussian_hole_clip: 0.8

# Gradient / field variance sampling
gradient_sampling_candidate_multiplier: 3
field_variance_k_neighbors: 10     # Larger k = smoother variance
field_variance_weight: 0.01         # Smaller = sharper (favor high variance)

# Sampling range (Angstrom); wider for larger molecules
sampling_range_min: -7.0
sampling_range_max: 7.0

n_query_points_per_type:
  C: 1000
  H: 1000
  O: 100
  N: 150
  F: 20
  S: 20
  Cl: 20
  Br: 20

method_configs:
  gaussian_mag:
    n_query_points: 3000  # More for larger molecules
    step_size: 0.003
    sig_sf: 0.1
    sig_mag: 0.45

  tanh:
    n_query_points: 2000
    step_size: 0.1
    sig_sf: 0.1
    sig_mag: 2

default_config: # softmax, logsumexp, inverse_square
  n_query_points: 1000
  step_size: 0.1
  sig_sf: 0.1
  sig_mag: 0.45
  eps: 0.1      # DBSCAN neighborhood radius
  min_samples: 3

# Autoregressive clustering (optional)
autoregressive_clustering:
  enable: False
  initial_min_samples: null
  min_samples_decay_factor: 0.7
  min_min_samples: 2
  max_clustering_iterations: 10
  bond_length_tolerance: 0.4  # Upper tolerance (Angstrom)
  bond_length_lower_tolerance: 0.2
  enable_bond_validation: False
  debug_bond_validation: True
  enable_clustering_history: False
  enable_timing: False
