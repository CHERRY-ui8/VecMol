sigma: 1
# Keep n_iter moderate; not all elements need full convergence
n_iter: 500  # Each iteration calls decoder (NOTE: use 600 if sampling range is -7 to 7)
# Early stopping (optional)
enable_early_stopping: False  # Stop when gradient converges to reduce iterations
convergence_threshold: 1e-6  # Gradient magnitude change threshold; only when early stopping enabled
min_iterations: 50  # Minimum iterations before early stopping

# Gradient batch size: balance GPU utilization and memory (null = all points; 2000â€“5000 often optimal)
gradient_batch_size: 2000

sigma_ratios:
  C: 0.9    # Carbon: smaller sigma -> more concentrated field
  H: 1.3    # Hydrogen: larger sigma -> more spread
  O: 1.1    # Oxygen: medium
  'N': 1.0    # Nitrogen: slightly smaller than O
  F: 1.2    # Fluorine: slightly larger than O
gradient_field_method: gaussian_hole # softmax, sfnorm, logsumexp, inverse_square, tanh, gaussian_mag, distance, gaussian_hole
temperature: 0.01 # Higher = sharper, easier convergence; lower = flatter, harder to converge
logsumexp_eps: 1e-8  # logsumexp numerical stability
inverse_square_strength: 1.0 # Inverse-square strength
gradient_clip_threshold: 0.3 # Gradient magnitude clip
gaussian_hole_clip: 0.8 # gaussian_hole distance clip upper bound

# Sampling by field variance
gradient_sampling_candidate_multiplier: 3  # Candidates = max_query_points * this
field_variance_k_neighbors: 10     # k for variance (larger k = smoother)
field_variance_weight: 0.01         # Softmax temp: smaller = sharper (favor high variance)

# Sampling range (Angstrom)
sampling_range_min: -4.0
sampling_range_max: 4.0

# Query points per atom type (optional; None = use unified n_query_points)
# Values below are for reduced range -4 to 4; use larger counts for -7 to 7
n_query_points_per_type:
  C: 200
  H: 200
  O: 30
  N: 30
  F: 15

# Method-specific configs
method_configs:
  gaussian_mag:
    n_query_points: 1000
    step_size: 0.1
    sig_sf: 0.1
    sig_mag: 0.45

  tanh:
    n_query_points: 2000
    step_size: 0.2
    sig_sf: 0.1
    sig_mag: 2

default_config: # softmax, logsumexp, inverse_square
  n_query_points: 600
  step_size: 0.1
  sig_sf: 0.1
  sig_mag: 0.45
  eps: 0.1
  min_samples: 3

# Autoregressive clustering (optional)
autoregressive_clustering:
  enable: False
  max_clustering_iterations: 10
  initial_min_samples: 80
  min_samples_decay_factor: 0.2
  min_min_samples: 5
  bond_length_tolerance: 2  # Upper tolerance (Angstrom) from standard bond length
  bond_length_lower_tolerance: 0.5  # Lower tolerance (Angstrom)
  n_initial_atoms_no_bond_check: 2  # First N atoms skip bond check
  debug_bond_validation: True
  enable_clustering_history: True
  save_gradient_ascent_sdf: True
  gradient_ascent_sdf_interval: 100
  enable_timing: True
