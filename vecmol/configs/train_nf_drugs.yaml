defaults:
  - dset: drugs
  - converter: gnf_converter_drugs
  - encoder: gnn_larger # gnn
  - decoder: decoder_global_larger # decoder_global
  - override hydra/job_logging: custom
  - _self_

debug: False
wandb: False
seed: 1234
exp_dir: ../exps/neural_field
exp_name: "nf_${dset.dset_name}/${now:%Y%m%d}"
dirname: "${exp_dir}/${exp_name}"

reload_model_path: null
auto_resume: True

# training params
ckpt_every_n_epochs: 1
n_epochs: 500
eval_every: 1

# Learning rate scheduler configuration
lr_decay: True
lr_scheduler_type: "plateau"  # "plateau" (ReduceLROnPlateau) or "multistep" (MultiStepLR)

# Warmup configuration
warmup:
  enabled: False
  warmup_steps: 10000

lr_factor: 0.8
lr_patience: 5
lr_min: 1e-6
lr_mode: "min"

lr_milestones: [30, 60, 90]
lr_gamma: 0.5

# Loss weighting: weight the more important regions (near atoms)
loss_weighting:
  enabled: False
  atom_distance_scale: 0.5
  grid_loss_weight: 1.0
  neighbor_loss_weight: 1.0

# Fine-tuning settings: freeze encoder and only train decoder
finetune_decoder:
  enabled: True
  freeze_encoder: True
  use_denoiser_for_codes: False
  denoiser_checkpoint_path: null
  sample_near_atoms_only: False
  atom_distance_threshold: 1
  n_points: 500
  cosine_loss_weight: 0
  length_loss_weight: 0
  max_timestep_for_decoder: 10
  code_augmentation:
    enabled: False
    noise_std: 0.003

# set the running dir
hydra:
  run:
    dir: ${dirname}
