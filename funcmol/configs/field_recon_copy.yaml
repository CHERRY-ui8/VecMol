# Field Reconstruction Evaluation Configuration

defaults:
  - dset: qm9  # 或 drugs
  - converter: gnf_converter_qm9  # 或 gnf_converter_drugs
  - encoder: gnn  # 添加 encoder 配置
  - decoder: decoder_global  # 添加 decoder 配置
  - override hydra/job_logging: custom
  - _self_

seed: 1234  # 随机种子，确保采样结果可重现

# 评估参数
max_samples: null  # 要评估的样本数量，null表示使用整个数据集，也可以指定具体数量如100
split: val  # 数据集分割：train/val/test，默认使用val数据集
# 手动指定要测试的样本索引（可选，优先级高于max_samples）
# 如果设置了此参数，将使用指定的索引列表，忽略max_samples参数
# sample_indices: [2,7,74,83,108,158,186,375,404,433,35,90,145,146,155,231,233,234,241,245,269,270,271,288,292,363,366,373,452]
# sample_indices: [35,90,145,146,155,231,233,234,241,245,269,270,271,288,292,363,366,373,452]  # 具体的索引列表，null表示不手动指定
# sample_indices: [0, 2, 33, 68, 113, 114, 194, 386, 414, 591, 606, 615, 656, 658, 759, 795, 841, 866, 867, 868, 1052, 1097, 1397, 1419, 1923, 2260, 2261, 2269, 2514, 2522, 3170, 3172, 3173, 3217, 3329, 3366, 3379, 3384, 3386, 3390, 3703, 3726, 3736, 3738, 3757, 3758, 3759, 3773, 3899, 3908, 3943, 3944, 4539, 4815, 4834, 4842, 4846, 4852, 4861, 4882, 4942, 5046, 5054, 5131, 5144, 5145, 5147, 5149, 5164, 5168, 5178, 5295, 5356, 5399, 5450, 5474, 5475, 5500, 5530, 5596, 5615, 5620, 5641, 5648, 6173, 6430, 6617, 6625, 7180, 7288, 7609, 7892, 7902]
sample_indices: null

# Field模式设置
field_mode: nf_field  # 'gt_field' 或 'nf_field'

# Field方法设置
field_methods: ['tanh']  # 要比较的field方法，现在已经确定了使用tanh方法

# 批量处理配置（用于优化性能）
# 如果设置为 > 1，将批量处理多个样本，可以显著减少decoder调用次数
# 例如：batch_size=8 时，decoder调用次数从 8×T 降到 T（T为迭代次数）
# 注意：所有样本必须有相同数量的query_points（当前实现已满足此条件）
reconstruction_batch_size: 1  # 批量大小，1表示逐个处理，>1表示批量处理

# 模型路径（仅在nf_field模式下需要）
nf_pretrained_path: /home/huayuchen/Neurl-voxel/exps/neural_field/nf_qm9/20251121/lightning_logs/version_1/checkpoints/model-epoch=999.ckpt
# nf_pretrained_path: /home/huayuchen/Neurl-voxel/exps/neural_field/nf_qm9/20251120/lightning_logs/version_0/checkpoints/model-epoch=259.ckpt
# 注意：输出目录将基于此路径自动创建，如: exps/neural_field/nf_qm9_20250804_153549_358664

# Hydra 设置
hydra:
  run:
    dir: ../exps/field_evaluation # NOTE：不得不设置一个这个参数

