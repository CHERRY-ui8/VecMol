defaults:
  - dset: qm9  # 或 drugs
  - converter: gnf_converter_qm9  # 或 gnf_converter_drugs
  - encoder: gnn  # 添加 encoder 配置
  - decoder: decoder_global  # 添加 decoder 配置
  - denoiser: gnn  # 添加 denoiser 配置
  - override hydra/job_logging: custom
  - _self_

# fm_pretrained_path: /datapool/data2/home/pxg/data/hyc/funcmol-main-neuralfield/exps/funcmol/fm_qm9/20251029/lightning_logs/version_0/checkpoints/model-epoch=199.ckpt
# fm_pretrained_path: /datapool/data2/home/pxg/data/hyc/funcmol-main-neuralfield/exps/funcmol/fm_qm9/20251103/lightning_logs/version_0/checkpoints/model-epoch=99.ckpt
fm_pretrained_path: /datapool/data2/home/pxg/data/hyc/funcmol-main-neuralfield/exps/funcmol/fm_qm9/20251111/lightning_logs/version_1/checkpoints/model-epoch=134.ckpt
dirname: ../exps/funcmol/fm_qm9/20251108

# 生成参数
max_samples: 1  # 要生成的分子数量
field_methods: ['tanh']  # 要使用的field方法

diffusion_method: "new_x0" #  方法选择: "old" (WJS) 或 "new" (DDPM) 或 "new_x0" (DDPM with x0)

# DDPM配置（仅当diffusion_method为"new"时使用）
ddpm:
  batch_size: 2  # DDPM采样的批次大小
  num_timesteps: 1000  # 精细方案：使用1000步以获得更细粒度的扩散过程
  hidden_dim: 128  # 与checkpoint中的实际模型架构保持一致
  num_layers: 4  # 与checkpoint中的实际模型架构保持一致
  time_emb_dim: 64  # 与checkpoint中的实际模型架构保持一致
  
  # Beta调度配置
  # 根据 num_timesteps 选择对应的 beta 配置：
  # - num_timesteps: 100   -> beta_start: 0.0005, beta_end: 0.05
  # - num_timesteps: 1000 -> beta_start: 0.0001, beta_end: 0.02
  beta_start: 0.0001  # 当 num_timesteps: 100 时使用0.0005；当 num_timesteps: 1000 时改为 0.0001
  beta_end: 0.02     # 当 num_timesteps: 100 时使用0.05；当 num_timesteps: 1000 时改为 0.02
  schedule: "linear"  # 可选: "linear", "cosine", "sigmoid"
  
  # Sigmoid调度参数（仅当schedule为"sigmoid"时使用）
  s1: 0.008
  sT: 0.008
  w: 1.0

# FuncMol denoiser 参数（必须）
smooth_sigma: 0.5

# 模型路径
nf_pretrained_path: /datapool/data3/storage/pengxingang/pxg/hyc/funcmol-main-neuralfield/exps/neural_field/nf_qm9/20251024/lightning_logs/version_0/checkpoints/model-epoch=409.ckpt

# set the running dir
hydra:
  run:
    dir: ${dirname}
