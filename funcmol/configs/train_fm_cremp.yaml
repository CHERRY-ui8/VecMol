defaults:
  - dset: cremp
  - encoder: cnn
  - decoder: decoder_global
  - denoiser: gnn
  - wjs: wjs_training_small
  - override hydra/job_logging: custom
  - _self_

debug: False
wandb: True
seed: 1234

diffusion_method: "new"  # "old" (WJS) 或 "new" (DDPM)

# DDPM配置（仅当diffusion_method为"new"时使用）
ddpm:
  # 模型配置
  hidden_dim: 128
  num_layers: 4
  time_emb_dim: 64
  dropout: 0.1
  
  # 扩散过程配置
  beta_start: 1e-4
  beta_end: 0.02
  num_timesteps: 1000
  schedule: "linear"  # 可选: "linear", "cosine", "sigmoid"
  
  # Cosine调度参数（仅当schedule为"cosine"时使用）
  s: 0.008  # cosine调度的偏移参数，控制余弦曲线的偏移，影响噪声添加的曲线形状（s越小曲线越陡峭，s越大曲线越平缓）
  
  # Sigmoid调度参数（仅当schedule为"sigmoid"时使用）
  s1: 0.008
  sT: 0.008
  w: 1.0
  
nf_pretrained_path: ../exps/neural_field/nf_cremp
exp_dir: ../exps/funcmol
exp_name: "fm_${dset.dset_name}_${now:%Y%m%d}_${now:%H%M%S}_${now:%f}"
dirname: "${exp_dir}/${exp_name}"
reload_model_path: null

# data params
smooth_sigma: 0.5
normalize_codes: 1
on_the_fly: True  # use False if codes are computed offline.
codes_dir: "${nf_pretrained_path}/codes/"
num_augmentations: null

# training params
num_epochs: 50000
dset:
  batch_size: 2048
sample_every: 50

# optim params
lr: 1e-3
use_lr_schedule: 1
num_warmup_iter: 4000
wd: 1e-2
ema_decay: 0.9999
max_grad_norm: 1.0  # 梯度裁剪阈值，防止梯度爆炸

# set the running dir
hydra:
  run:
    dir: ${dirname}
  job:
    config:
      override_dirname:
        kv_sep: ""
        item_sep: "_"
        exclude_keys: ["exp_dir"]
